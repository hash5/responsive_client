<!DOCTYPE html>
<head>
    <title>Unit Tests - hash5.model.EntryParser</title>
    <script src="../../../../closure-library/closure/goog/base.js"></script>
    <script src="../../deps.js"></script>
</head>
<body>
    <script>
        goog.require('hash5.model.EntryParser');
        goog.require('hash5.model.Entry');

        goog.require('goog.testing.jsunit');
        goog.require('goog.events.EventHandler');
        goog.require('goog.testing.AsyncTestCase');
    </script>
    <script>
        var asyncTestCase = goog.testing.AsyncTestCase.createAndInstall();

        /** @type {hash5.model.Entry} */
        var testEntry;

        /** @type {goog.events.EventHandler} */
        var eventHandler;

        function setUp()
        {
            if(eventHandler){
                eventHandler.dispose();
            }
            eventHandler = new goog.events.EventHandler();
        }

        function testACreateTestModel()
        {
            asyncTestCase.waitForAsync('wait for model saved');


            testEntry = new hash5.model.Entry();
            testEntry.setText("Dies ist mein #beispieltext mit #hash #hashCompex=bla");
            testEntry.save(function(){
                asyncTestCase.continueTesting();
            });
        }

        function testBParseHashtags()
        {
            var parser = new hash5.model.EntryParser(testEntry);

            var parseResult = parser.toString();
            var expected = 'Dies ist mein <a class="hash-link simple" href="/search/%23beispieltext">#beispieltext</a> mit <a class="hash-link simple" href="/search/%23hash">#hash</a> <a class="hash-link simple" href="/search/%23hashCompex">#hashCompex</a>=bla';

            assertEquals(parseResult, expected);
        }
    </script>
</body>
</html>